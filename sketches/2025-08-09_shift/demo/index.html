<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Live Demo</title>
  <style>
    :root { color-scheme: dark light; }
    html,body { height: 100%; margin: 0; }
    body { background:#0b0b0e; color:#eaeaea; font:14px/1.45 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;}
    .bar { display:flex; gap:8px; padding:16px; align-items:center; }
    button { padding:8px 12px; border-radius:10px; border:0; background:#fff; color:#111; cursor:pointer; }
    main { display:grid; place-items:center; padding:16px; }
    .stage { width:min(1200px, 100%); aspect-ratio:4/5; background:#111; border-radius:16px; display:grid; place-items:center; }
    canvas { max-width:100%; max-height:100%; background:#000; border-radius:12px; display:block; }
    /* прячем play/pause, если открыто не в iframe */
    body.external-view button[aria-label="Play"],
    body.external-view button[aria-label="Pause"] { display:none; }
  </style>
</head>
<body>
  <div class="bar">
    <button id="btnPlay"  aria-label="Play">Play</button>
    <button id="btnPause" aria-label="Pause">Pause</button>
    <button id="btnFS"    aria-label="Fullscreen">Fullscreen</button>
  </div>

  <main>
    <div class="stage"><canvas id="c"></canvas></div>
  </main>

  <!-- твой скетч -->
  <script type="module" src="./sketch.js"></script>

  <script>
    // если открыто в отдельной вкладке (не в iframe) — скрываем play/pause
    if (window.self === window.top) {
      document.body.classList.add('external-view');
    }

    // Горячие клавиши: Space = Play/Pause, F = Fullscreen
    document.addEventListener('keydown', (e) => {
      if (e.code === 'Space') {
        e.preventDefault();
        // нажмём «Pause», если есть; иначе «Play»
        const btn = document.querySelector('button[aria-label="Pause"]') || document.querySelector('button[aria-label="Play"]');
        btn?.click();
      }
      if (e.code === 'KeyF') {
        e.preventDefault();
        if (!document.fullscreenElement) document.documentElement.requestFullscreen();
        else document.exitFullscreen();
      }
    });

    // Автофокус на канвас (для мгновенных хоткеев)
    window.addEventListener('load', () => document.getElementById('c')?.focus());

    // Проводка кнопок (ожидаем, что скетч выставит window.__demo.play/pause)
    btnPlay.onclick  = () => window.__demo?.play?.();
    btnPause.onclick = () => window.__demo?.pause?.();
    btnFS.onclick    = () => (!document.fullscreenElement ? document.documentElement.requestFullscreen() : document.exitFullscreen());
  </script>
</body>
</html>
